name: 'ONVM CI'
on:
  pull_request:
    types: [opened]
  issue_comment:
    types: [created]
jobs:
  deploypr:
    runs-on: ubuntu-latest
    steps:
      - uses: khan/pull-request-comment-trigger@master
        id: check
        with:
          trigger: 'onvm'
          prefix_only: 'true'
          reaction: rocket
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
      - name: Triggered
        if: steps.check.outputs.triggered == 'true'
        run: |
          echo 'Found CI!'
          echo $GITHUB_RUN_ID
      - name: Add comment to PR
        env:
          URL: ${{ github.event.issue.comments_url }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          curl \
            -X POST \
            $URL \
            -H "Content-Type: application/json" \
            -H "Authorization: token $GITHUB_TOKEN" \
            --data '{ "body": "[Passed] Check [Github Action results](https://github.com/kevindweb/openNetVM/actions/runs/${GITHUB_RUN_ID})" }'
